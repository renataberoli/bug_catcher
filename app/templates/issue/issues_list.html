{% extends 'issue/base.html' %}

{% block content %}
    <div class="card mh-100">
        <div class="card-body">
            <h1>Issues List</h1>
            <form class="row g-4" action="." method="GET">
                <div class="col-4">
                    <label>Search field</label>
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="search by text" aria-label="search field"
                           aria-describedby="button-addon2" name="data">
                        <button class="btn btn-outline-secondary" type="submit" id="button-addon2"><ion-icon
                                name="search-outline"></ion-icon>
                        </button>
                    </div>
                </div>
                <div class="col-auto">
                    <label>Priority</label>
                    <select class="form-select" aria-label="priority select" name="priority">
                        <option selected></option>
                        <option value="1">Urgent</option>
                        <option value="2">High</option>
                        <option value="3">Normal</option>
                        <option value="4">Low</option>
                    </select>
                </div>
                <div class="col-auto">
                    <label>Status</label>
                    <select class="form-select" aria-label="status select" name="status">
                    <option selected></option>
                    <option value="open">Open</option>
                    <option value="pending">Pending</option>
                    <option value="closed">Closed</option>
                </select>
                </div>
                <div class="col-auto">
                    <label>Label</label>
                    <select class="form-select" aria-label="label select" name="label">
                    <option selected></option>
                    <option value="frontend">Front-end</option>
                    <option value="backend">Back-end</option>
                    <option value="design">Design</option>
                    <option value="operational">Operational</option>
                </select>
                </div>
                <div class="col-auto">
                    <label>Assigned to me</label>
                    <div class="form-check">
                        <input class="form-check-input" id="flexCheckDefault" type="checkbox" name="assigned-to-me">
                    </div>
                </div>
                <div class="col-auto">
                    <button class="btn btn-outline-primary" type="submit">
                        Search
                    </button>
                </div>
            </form>
            <div>
                <a href="{% url 'issue_list' %}">Clear filters</a>
            </div>
            <table class="table table-responsive table-striped">
                <thead>
                <tr>
                    <th scope="col">ID</th>
                    <th scope="col">Priority</th>
                    <th scope="col">Title</th>
                    <th scope="col">Description</th>
                    <th scope="col">Project</th>
                    <th scope="col">Label</th>
                    <th scope="col">Author</th>
                    <th scope="col">Assignee to</th>
                    <th scope="col">Status</th>
                </tr>
                </thead>
                <tbody>
                {% for issue in page_obj %}
                <tr>
                    <td scope="row">#{{ issue.id }}</td>
                    {% if issue.priority == "1" %}
                    <td class="bg-danger text-light">{{ issue.get_priority_display }}</td>
                    {% elif issue.priority == "2" %}
                    <td class="bg-warning text-dark">{{ issue.get_priority_display }}</td>
                    {% elif issue.priority == "3" %}
                    <td class="bg-primary text-light">{{ issue.get_priority_display }}</td>
                    {% else %}
                    <td class="bg-success text-light">{{ issue.get_priority_display }}</td>
                    {% endif %}
                    <td class="text-truncate" style="max-width: 300px;"><a href="{% url 'issue_detail' pk=issue.pk %}">{{ issue.title }}</a></td>
                    <td class="text-truncate" style="max-width: 300px;">{{ issue.description }}</td>
                    <td>{{ issue.project }}</td>
                    <td>{{ issue.get_label_display }}</td>
                    <td>{{ issue.author }}</td>
                    <td>{{ issue.assignee }}</td>
                    <td>{{ issue.get_status_display }}</td>
                </tr>
                {% endfor %}
                </tbody>
            </table>
            <div class="pagination">
                <span class="step-links">
                    {% if page_obj.has_previous %}
                        <a href="?page={{ page_obj.previous_page_number }}"><<</a>
                    {% endif %}

                    <span class="current">
                        Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
                    </span>

                    {% if page_obj.has_next %}
                        <a href="?page={{ page_obj.next_page_number }}">>></a>
                    {% endif %}
                </span>
            </div>
        </div>
    </div>
{% endblock %}

